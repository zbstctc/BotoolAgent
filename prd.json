{
  "project": "Stage 2 规范检查功能改造",
  "branchName": "botool/stage2-rule-check-redesign",
  "description": "将 Stage 2 规范检查步骤从 mock 数据改为真实的规范选择和 CLI 适配流程。用户从 Dashboard 规范文档系统中选择规范，点击确认后，CLI 自动按规范适配 PRD，无需逐项确认。",
  "devTasks": [
    {
      "id": "DT-001",
      "title": "改造 RuleCheckStep 为规范选择界面",
      "description": "重写 RuleCheckStep 组件，从规范检查改为规范选择。加载 Dashboard 规范文档，按分类展示为可折叠卡片。",
      "acceptanceCriteria": [
        "调用 /api/rules GET 获取所有规范",
        "按分类（frontend, backend, testing 等）分组展示",
        "每个分类显示为可折叠的垂直卡片",
        "支持全选/分类全选/单个勾选",
        "显示已选规范数量统计",
        "Typecheck passes",
        "Verify in browser"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-002",
      "title": "实现 CLI 规范适配逻辑",
      "description": "用户点击确认后，调用 CLI 按选中的规范适配 PRD。使用 SSE 流式传输显示适配进度。",
      "acceptanceCriteria": [
        "点击确认按钮后调用 /api/cli/chat",
        "发送包含选中规范和 PRD 内容的 prompt",
        "使用 SSE 流式传输接收适配进度",
        "显示进度条（根据 SSE 事件更新）",
        "适配过程中禁用确认按钮",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-003",
      "title": "实现适配完成确认弹窗",
      "description": "CLI 适配完成后，显示确认弹窗，展示适配结果摘要。",
      "acceptanceCriteria": [
        "适配完成后弹出确认弹窗",
        "显示已应用的规范列表",
        "显示 PRD 修改摘要（如有）",
        "点击确认进入下一步",
        "Typecheck passes",
        "Verify in browser"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-004",
      "title": "改造 CodeExampleStep 为 CLI 集成",
      "description": "将 CodeExampleStep 从 mock 数据改为 CLI 集成，自动生成代码示例。",
      "acceptanceCriteria": [
        "调用 CLI 生成代码示例",
        "SSE 流式传输显示生成进度",
        "展示生成的代码示例列表",
        "支持用户编辑/采纳/跳过",
        "Typecheck passes",
        "Verify in browser"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-005",
      "title": "改造 TestCaseStep 为 CLI 集成",
      "description": "将 TestCaseStep 从 mock 数据改为 CLI 集成，自动生成测试用例。",
      "acceptanceCriteria": [
        "调用 CLI 生成测试用例",
        "SSE 流式传输显示生成进度",
        "分类展示单元测试和 E2E 测试",
        "支持用户编辑/采纳/跳过",
        "Typecheck passes",
        "Verify in browser"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-006",
      "title": "改造 JsonConvertStep 为 CLI 集成",
      "description": "将 JsonConvertStep 从 mock 数据改为 CLI 集成，自动转换 PRD 为 JSON。",
      "acceptanceCriteria": [
        "调用 CLI 将 PRD 转换为 prd.json 格式",
        "SSE 流式传输显示转换进度",
        "展示 JSON 编辑器",
        "支持保存到项目根目录",
        "Typecheck passes",
        "Verify in browser"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    },
    {
      "id": "DT-007",
      "title": "端到端测试",
      "description": "测试完整的 Stage 2 流程，确保所有步骤正常工作。",
      "acceptanceCriteria": [
        "规范选择正确加载和展示",
        "CLI 适配流程正常工作",
        "代码示例生成正常",
        "测试用例生成正常",
        "JSON 转换和保存正常",
        "Verify in browser"
      ],
      "priority": 7,
      "passes": true,
      "notes": ""
    }
  ]
}