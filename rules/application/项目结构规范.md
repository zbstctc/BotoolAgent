# 项目结构规范

## 目录结构
```
viewer/src/
├── app/                   # Next.js App Router
│   ├── api/               # API 路由（服务端）
│   │   ├── {feature}/route.ts
│   │   └── {feature}/[id]/route.ts
│   ├── stage{1-5}/page.tsx  # 5 阶段页面
│   ├── page.tsx           # Dashboard 首页
│   ├── layout.tsx         # 根布局（含 Provider）
│   └── globals.css        # 全局样式 + 自定义动画
├── components/            # UI 组件
│   ├── {Component}.tsx    # 独立组件
│   ├── {domain}/          # 领域组件子目录
│   │   ├── {Component}.tsx
│   │   └── index.ts       # barrel export
│   └── index.ts           # 总 barrel export
├── contexts/              # React Context
│   └── {Name}Context.tsx
├── hooks/                 # 自定义 Hooks
│   ├── use{Feature}.ts
│   └── index.ts
└── lib/                   # 工具库（服务端 + 客户端共用）
    ├── project-root.ts    # 路径工具（服务端）
    ├── tool-types.ts      # 共享类型定义
    ├── cli-manager.ts     # Claude CLI 管理
    └── {feature}.ts       # 功能模块
```

## 文件职责
- **page.tsx**：页面入口，组合组件，管理页面级状态
- **components/**：纯 UI 逻辑，通过 props 接收数据
- **hooks/**：可复用的状态逻辑，不包含 UI
- **lib/**：纯工具函数，无 React 依赖（除类型定义）
- **contexts/**：全局共享状态

## 新文件规则
- 新组件先检查 `components/` 是否有可复用的
- 新 API 遵循 RESTful 命名：`/api/{资源名}/{动作}`
- 新 hook 必须以 `use` 前缀命名，放在 `hooks/` 目录
- 新建文件后必须更新对应的 barrel `index.ts`

## 技术栈版本
- Next.js 16+ (App Router)
- React 19+
- TypeScript 5+ (strict mode)
- Tailwind CSS 4+
- Playwright（E2E 测试）
