# PRD: BotoolAgent Remote Access + Mobile PWA

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 èƒŒæ™¯ä¸åŠ¨æœº

BotoolAgent Viewer å½“å‰ä»…æ”¯æŒé€šè¿‡ `localhost:3100` è®¿é—®ï¼Œå¼€å‘è€…ç¦»å¼€ç”µè„‘åæ— æ³•æŸ¥çœ‹ Agent çš„å¼€å‘è¿›åº¦ã€æ—¥å¿—æˆ–æ‰§è¡ŒçŠ¶æ€ã€‚è¿™æ„å‘³ç€åœ¨å¤–å‡ºã€é€šå‹¤æˆ–ä¼‘æ¯æ—¶ï¼Œå¼€å‘è€…åªèƒ½è¢«åŠ¨ç­‰å¾…ï¼Œæ— æ³•åŠæ—¶å“åº” Agent éœ€è¦çš„ç¡®è®¤æ“ä½œï¼ˆå¦‚ PRD ç¡®è®¤ã€åˆå¹¶å®¡æ‰¹ï¼‰ï¼Œå¯¼è‡´å¼€å‘æµç¨‹è¢«é˜»å¡ã€‚

### 1.2 æ ¸å¿ƒç›®æ ‡

1. **è¿œç¨‹è®¿é—®** â€” é€šè¿‡ Cloudflare Tunnel å°†æœ¬åœ° Viewer å®‰å…¨æš´éœ²åˆ°å…¬ç½‘ï¼Œå¼€å‘è€…å¯ä»ä»»ä½•è®¾å¤‡è®¿é—®
2. **ç§»åŠ¨ç«¯ PWA** â€” æ‰‹æœºå¯å®‰è£…ä¸º PWA åº”ç”¨ï¼Œè·å¾—æ¥è¿‘åŸç”Ÿ App çš„ä½“éªŒï¼ˆå®Œæ•´æ“ä½œèƒ½åŠ›ï¼‰
3. **å®æ—¶æ¨é€é€šçŸ¥** â€” Agent çŠ¶æ€å˜æ›´ï¼ˆå®Œæˆ/é”™è¯¯/æµ‹è¯•/ç¡®è®¤ï¼‰å®æ—¶æ¨é€åˆ°æ‰‹æœºï¼Œå¼€å‘è€…ä¸é”™è¿‡å…³é”®äº‹ä»¶
4. **å“åº”å¼ UI** â€” æ‰€æœ‰ç°æœ‰é¡µé¢é€‚é…æ‰‹æœºå±å¹•ï¼Œåº•éƒ¨å¯¼èˆª + å¯æ‹–æ‹½é¢æ¿æä¾›æµç•…ç§»åŠ¨æ“ä½œä½“éªŒ

### 1.3 æˆåŠŸæŒ‡æ ‡

- ç§»åŠ¨ç«¯é¦–å±åŠ è½½ < 3 ç§’
- PWA å®‰è£…å¼•å¯¼æµç•…ï¼Œæ”¯æŒ iOS Safari + Chrome Android
- æ‰€æœ‰ 7 ä¸ªç°æœ‰é¡µé¢ + 1 ä¸ªæ–°å¢é¡µé¢å®Œæˆç§»åŠ¨ç«¯é€‚é…
- éš§é“ä¸€é”®å¯åŠ¨ï¼ŒURL è‡ªåŠ¨åŒæ­¥åˆ° Viewer ç•Œé¢
- æ¨é€é€šçŸ¥åœ¨ Agent å…³é”®äº‹ä»¶æ—¶ 5 ç§’å†…é€è¾¾

## 2. å½“å‰çŠ¶æ€

### 2.1 å·²æœ‰èƒ½åŠ›

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Viewer Web UI | âœ… å·²å®ç° | 7 ä¸ªé¡µé¢ï¼ˆDashboard + Stage1-5 + Rulesï¼‰ï¼Œ44+ API ç«¯ç‚¹ |
| Header + TabBar | âœ… å·²å®ç° | æ¡Œé¢ç«¯ Tab å¯¼èˆªï¼Œhover popover é¡¹ç›®é¢„è§ˆ |
| Agent çŠ¶æ€ API | âœ… å·²å®ç° | `/api/agent/status`ã€`/api/agent/logs` ç­‰ |
| æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ | âœ… å·²å®ç° | tasks/ã€registry.json ç­‰æ–‡ä»¶ I/O |
| BotoolAgent.sh | âœ… å·²å®ç° | tmux å¤–å¾ªç¯ï¼Œæ”¯æŒ `--project-dir`ã€`--project-id` å‚æ•° |
| shadcn/ui ç»„ä»¶ | âœ… å·²å®ç° | buttonã€dialogã€badgeã€tabsã€popover ç­‰ |

### 2.2 ç¼ºå£åˆ†æ

| ç¼ºå£ | è¯´æ˜ |
|------|------|
| PWA æ”¯æŒ | âŒ æ—  manifest.jsonã€æ—  Service Workerã€æ— å®‰è£…æç¤º |
| ç§»åŠ¨ç«¯é€‚é… | âŒ å¸ƒå±€ä½¿ç”¨ `h-screen overflow-hidden`ï¼Œæ¡Œé¢ä¼˜å…ˆï¼Œæ— å“åº”å¼æ–­ç‚¹ |
| è¿œç¨‹è®¿é—® | âŒ ä»…ç›‘å¬ localhost:3100ï¼Œæ— éš§é“é›†æˆ |
| è®¤è¯ä¿æŠ¤ | âŒ æ‰€æœ‰ API ç«¯ç‚¹æ— è®¤è¯ï¼Œä¸é€‚åˆå…¬ç½‘æš´éœ² |
| æ¨é€é€šçŸ¥ | âŒ æ—  Web Pushã€æ—  SSE äº‹ä»¶æµ |
| ç§»åŠ¨å¯¼èˆª | âŒ æ— åº•éƒ¨å¯¼èˆªæ ã€æ— åº•éƒ¨æŠ½å±‰é¢æ¿ |

## 3. æ¶æ„è®¾è®¡

### 3.1 æ ¸å¿ƒæ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°æœºå™¨                                      â”‚
â”‚                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ BotoolAgentâ”‚  â”‚ Viewer :3100          â”‚    â”‚
â”‚  â”‚ (tmux+CLI) â”‚  â”‚                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚       â”‚          â”‚ â”‚ PWA Layer         â”‚ â”‚    â”‚
â”‚       â”‚ API      â”‚ â”‚ â€¢ manifest.json   â”‚ â”‚    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â–¶   â”‚ â”‚ â€¢ sw.js (cache)   â”‚ â”‚    â”‚
â”‚                  â”‚ â”‚ â€¢ Web Push (VAPID)â”‚ â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚ tunnel.sh  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ start/stop â”‚  â”‚ â”‚ Mobile UI Layer   â”‚ â”‚    â”‚
â”‚  â”‚ status     â”‚  â”‚ â”‚ â€¢ MobileNav       â”‚ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ â€¢ BottomSheet     â”‚ â”‚    â”‚
â”‚        â”‚ writes  â”‚ â”‚ â€¢ Responsive      â”‚ â”‚    â”‚
â”‚        â–¼         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   tunnel-status  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   .json          â”‚ â”‚ Push + SSE        â”‚ â”‚    â”‚
â”‚                  â”‚ â”‚ â€¢ /api/push/*     â”‚ â”‚    â”‚
â”‚                  â”‚ â”‚ â€¢ /api/sse/events â”‚ â”‚    â”‚
â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Cloudflare Tunnel     â”‚
                   â”‚ + CF Access (ZeroTrust)â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTPS
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ æ‰‹æœº / å¹³æ¿            â”‚
                   â”‚ PWA å®‰è£…              â”‚
                   â”‚ Web Push æ¥æ”¶         â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç”¨æˆ·è§’è‰²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼€å‘è€…ï¼ˆå•ç”¨æˆ·ï¼‰                   â”‚
â”‚                                    â”‚
â”‚  è®¿é—®æ–¹å¼:                         â”‚
â”‚    â€¢ æœ¬åœ°: localhost:3100          â”‚
â”‚    â€¢ è¿œç¨‹: CF Tunnel URL           â”‚
â”‚    â€¢ PWA: å®‰è£…åä»ä¸»å±å¹•å¯åŠ¨       â”‚
â”‚                                    â”‚
â”‚  æƒé™: å…¨éƒ¨ï¼ˆå•ç”¨æˆ·æ— æƒé™åŒºåˆ†ï¼‰     â”‚
â”‚                                    â”‚
â”‚  è®¤è¯:                             â”‚
â”‚    â€¢ æœ¬åœ°è®¿é—®: æ— éœ€è®¤è¯             â”‚
â”‚    â€¢ è¿œç¨‹è®¿é—®: CF Access OTP       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¿é—®çŸ©é˜µ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ“ä½œ       â”‚ æœ¬åœ°   â”‚ è¿œç¨‹   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŸ¥çœ‹çŠ¶æ€   â”‚  âœ”     â”‚  âœ”     â”‚
â”‚ æ“ä½œ Viewerâ”‚  âœ”     â”‚  âœ”     â”‚
â”‚ ç®¡ç†éš§é“   â”‚  âœ”     â”‚  âœ”     â”‚
â”‚ æ¥æ”¶æ¨é€   â”‚  âœ”     â”‚  âœ”     â”‚
â”‚ å¯åœéš§é“   â”‚  CLI   â”‚  âœ–     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ ¸å¿ƒå·¥ä½œæµ

```
Phase 1 â”€â”€â–¶ Phase 3
éš§é“åŸºå»º     ç§»åŠ¨ç«¯ UI
(P0)         (P0)

Phase 2 â”€â”€â–¶ Phase 4
PWA åŸºç¡€     æ¨é€é€šçŸ¥
(P0)         (P1)

Phase 1 + 2 å¯å¹¶è¡Œ
Phase 3 + 4 å¯å¹¶è¡Œï¼ˆåœ¨å„è‡ªå‰ç½®å®Œæˆåï¼‰
```

### 3.4 éš§é“çŠ¶æ€æœº

```
         tunnel.sh start
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”  cloudflared  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  URL parsed  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ off â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚starting â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ running â”‚
â””â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â–²                                                â”‚
   â”‚              tunnel.sh stop                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  æˆ– cloudflared å´©æºƒ

çŠ¶æ€å­˜å‚¨: tunnel-status.json
  off      â†’ æ–‡ä»¶ä¸å­˜åœ¨æˆ– status="stopped"
  starting â†’ status="starting", pid=N
  running  â†’ status="running", pid=N, url="https://..."
```

## 4. æ•°æ®è®¾è®¡

### 4.1 æ•°æ®æ¨¡å‹æ¦‚è§ˆ

| æ–‡ä»¶ | ç”¨é€” | å…³é”®å­—æ®µ | çŠ¶æ€ |
|------|------|---------|------|
| `tunnel-status.json` | éš§é“è¿è¡ŒçŠ¶æ€ | status, url, pid, startedAt | æ–°å»º |
| `push-subscriptions.json` | Push è®¢é˜…ä¿¡æ¯ | endpoint, keys, createdAt | æ–°å»º |
| `.vapid-keys.json` | VAPID å¯†é’¥å¯¹ | publicKey, privateKey | æ–°å»º(è‡ªåŠ¨ç”Ÿæˆ) |
| `manifest.json` | PWA æ¸…å• | name, icons, display, start_url | æ–°å»º |
| `agent-status.json` | Agent è¿è¡ŒçŠ¶æ€ | status, progress, currentDT | å·²æœ‰(æ¨é€è¯»å–) |

### 4.2 æ–‡ä»¶ Schema å®šä¹‰

```jsonc
// tunnel-status.json â€” ç”± tunnel.sh å†™å…¥ï¼Œ/api/tunnel/status è¯»å–
{
  "status": "running" | "starting" | "stopped",
  "url": "https://xxx.trycloudflare.com",  // ä»… running æ—¶å­˜åœ¨
  "pid": 12345,                              // cloudflared è¿›ç¨‹ PID
  "startedAt": "2026-02-20T10:00:00Z",
  "service": "cloudflared"                   // éš§é“æœåŠ¡ç±»å‹
}
```

```jsonc
// push-subscriptions.json â€” ç”± /api/push/subscribe å†™å…¥
{
  "subscriptions": [
    {
      "endpoint": "https://fcm.googleapis.com/fcm/send/...",
      "keys": {
        "p256dh": "...",
        "auth": "..."
      },
      "createdAt": "2026-02-20T10:00:00Z",
      "userAgent": "Chrome Android"
    }
  ]
}
```

```jsonc
// .vapid-keys.json â€” é¦–æ¬¡è®¢é˜…æ—¶è‡ªåŠ¨ç”Ÿæˆï¼ŒåŠ å…¥ .gitignore
{
  "publicKey": "BEl62i...",
  "privateKey": "UGXp..."
}
```

```jsonc
// manifest.json (viewer/public/)
{
  "name": "Botool Agent",
  "short_name": "Botool",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#fafafa",
  "theme_color": "#171717",
  "icons": [
    { "src": "/icons/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "/icons/icon-512.png", "sizes": "512x512", "type": "image/png" },
    { "src": "/icons/icon-maskable-512.png", "sizes": "512x512", "type": "image/png", "purpose": "maskable" }
  ]
}
```

### 4.3 æ–‡ä»¶å…³ç³»

```
tunnel.sh â”€â”€writesâ”€â”€â–¶ tunnel-status.json
/api/tunnel/status â”€â”€readsâ”€â”€â–¶ tunnel-status.json
/api/push/subscribe â”€â”€writesâ”€â”€â–¶ push-subscriptions.json
/api/push/send â”€â”€readsâ”€â”€â–¶ push-subscriptions.json
/api/push/vapid-public â”€â”€readsâ”€â”€â–¶ .vapid-keys.json
agent-status.json â”€â”€triggersâ”€â”€â–¶ /api/push/send
```

## 5. UI è®¾è®¡

### 5.1 é¡µé¢æ¸…å•

| é¡µé¢ | è·¯ç”± | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|------|
| Dashboard | `/` | é¡¹ç›®åˆ—è¡¨ + çŠ¶æ€æ¦‚è§ˆ | å·²æœ‰(éœ€é€‚é…) |
| Stage 1 - PRD | `/stage1` | PRD ç¼–å†™ | å·²æœ‰(éœ€é€‚é…) |
| Stage 3 - å¼€å‘ | `/stage3` | è‡ªåŠ¨å¼€å‘ç›‘æ§ | å·²æœ‰(éœ€é€‚é…) |
| Stage 4 - æµ‹è¯• | `/stage4` | æµ‹è¯•éªŒè¯ | å·²æœ‰(éœ€é€‚é…) |
| Stage 5 - åˆå¹¶ | `/stage5` | åˆå¹¶å‘å¸ƒ | å·²æœ‰(éœ€é€‚é…) |
| Rules | `/rules` | è§„åˆ™ç®¡ç† | å·²æœ‰(éœ€é€‚é…) |
| éš§é“ç®¡ç† | `/tunnel` | éš§é“çŠ¶æ€/URL/æ“ä½œ | **æ–°å»º** |
| ç¦»çº¿å›é€€ | `/offline` | æ–­ç½‘æç¤ºé¡µ | **æ–°å»º** |

### 5.2 ç»„ä»¶æ¸…å•

| ç»„ä»¶ | Props æ¥å£ | å¤ç”¨ä½ç½® | çŠ¶æ€ |
|------|-----------|---------|------|
| `MobileNav` | `{ className?: string }` | layout.tsx (å…¨å±€) | **æ–°å»º** |
| `BottomSheet` | `{ children, defaultSnap, title }` | Stage3, Stage4, Stage5 | **æ–°å»º** |
| `TunnelIndicator` | `{ className?: string }` | Header.tsx | **æ–°å»º** |
| `InstallPrompt` | `{ }` | layout.tsx (å…¨å±€) | **æ–°å»º** |
| `Header` | `{ }` | layout.tsx (å…¨å±€) | ä¿®æ”¹(å“åº”å¼) |
| `Main` | `{ children }` | layout.tsx (å…¨å±€) | ä¿®æ”¹(åº•éƒ¨å¯¼èˆªç©ºé—´) |
| `TabBar` | `{ className? }` | Header.tsx | ä¿®æ”¹(å¤§å±æ˜¾ç¤º) |

### 5.3 å…³é”®é¡µé¢å¸ƒå±€

```
â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç§»åŠ¨ç«¯ Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Botool Agent       [â— éš§é“]  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ é¡¹ç›®å¡ç‰‡ 1                â”‚â”‚
â”‚  â”‚ â— S3 è¿è¡Œä¸­  3/5 DT      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ é¡¹ç›®å¡ç‰‡ 2                â”‚â”‚
â”‚  â”‚ â—‹ S1 ç©ºé—²    0/0 DT      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                               â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ [ğŸ é¦–é¡µ] [ğŸ“é¡¹ç›®] [ğŸ”—éš§é“] [âš™è®¾ç½®]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç§»åŠ¨ç«¯ Stage3 (æŠ½å±‰å±•å¼€) â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Stage 3: è‡ªåŠ¨å¼€å‘    [â—]   â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  3/5   â”‚
â”‚                               â”‚
â”‚ â˜‘ DT-001 æ•°æ®åº“ Schema       â”‚
â”‚ â˜‘ DT-002 API ç«¯ç‚¹            â”‚
â”‚ â–¶ DT-003 å‰ç«¯ç»„ä»¶  è¿è¡Œä¸­    â”‚
â”‚ â—‹ DT-004 æµ‹è¯•                â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â”‚
â”‚ Agent æ—¥å¿—                    â”‚
â”‚ > Installing deps...          â”‚
â”‚ > Running typecheck...        â”‚
â”‚ > Creating component...       â”‚
â”‚                               â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ [ğŸ é¦–é¡µ] [ğŸ“é¡¹ç›®] [ğŸ”—éš§é“] [âš™è®¾ç½®]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€ éš§é“ç®¡ç†é¡µ /tunnel â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† éš§é“ç®¡ç†                    â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚    â— éš§é“å·²è¿æ¥            â”‚â”‚
â”‚  â”‚                           â”‚â”‚
â”‚  â”‚  URL:                     â”‚â”‚
â”‚  â”‚  https://xxx.tryclou..    â”‚â”‚
â”‚  â”‚           [å¤åˆ¶ URL]      â”‚â”‚
â”‚  â”‚                           â”‚â”‚
â”‚  â”‚  è¿è¡Œæ—¶é•¿: 2h 15m         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                               â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ [ğŸ é¦–é¡µ] [ğŸ“é¡¹ç›®] [ğŸ”—éš§é“] [âš™è®¾ç½®]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 Header éš§é“æŒ‡ç¤ºå™¨

```
æ¡Œé¢ç«¯ Header (éš§é“åœ¨çº¿):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Botool Agent [Viewer] | TabBar...  repo  12:00 [â—ğŸŸ¢]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â†‘
                                         ç‚¹å‡»å¼¹å‡º Popover:
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚ â— éš§é“å·²è¿æ¥     â”‚
                                         â”‚ https://xxx...   â”‚
                                         â”‚ [å¤åˆ¶ URL]       â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¡Œé¢ç«¯ Header (éš§é“ç¦»çº¿/æœªå¯åŠ¨):
â†’ æŒ‡ç¤ºå™¨å®Œå…¨éšè—ï¼Œä¸æ˜¾ç¤º

ç§»åŠ¨ç«¯ Header:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Botool Agent       [â— éš§é“]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†’ TabBar éšè—ï¼Œä»…æ˜¾ç¤ºå“ç‰Œå + éš§é“æŒ‡ç¤ºå™¨
â†’ éš§é“æœªå¯åŠ¨æ—¶æŒ‡ç¤ºå™¨éšè—
```

### 5.5 åº•éƒ¨æŠ½å±‰ BottomSheet è¡Œä¸º

```
ä¸¤æ¡£å¡ç‚¹:

  æ”¶èµ·çŠ¶æ€ (é»˜è®¤):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ä¸»å†…å®¹åŒºåŸŸ                     â”‚
  â”‚ (ä»»åŠ¡åˆ—è¡¨/PRD/ç­‰)              â”‚
  â”‚                               â”‚
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚â–”â–” Agent æ—¥å¿— â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â”‚ â† æ ‡é¢˜æ  + æ‹–æ‹½æ‰‹æŸ„
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚ [ğŸ é¦–é¡µ] [ğŸ“é¡¹ç›®] [ğŸ”—éš§é“] [âš™è®¾ç½®]â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  å±•å¼€çŠ¶æ€ (ä¸Šæ‹–è‡³ 70%):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ä¸»å†…å®¹åŒºåŸŸ (30%)               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚â–”â–” Agent æ—¥å¿— â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â”‚
  â”‚ > Installing deps...          â”‚
  â”‚ > Running typecheck...        â”‚
  â”‚ > Creating component...       â”‚
  â”‚ > [cursor blink]              â”‚
  â”‚                               â”‚
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚ [ğŸ é¦–é¡µ] [ğŸ“é¡¹ç›®] [ğŸ”—éš§é“] [âš™è®¾ç½®]â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6. ä¸šåŠ¡è§„åˆ™

### 6.1 éš§é“è§„åˆ™

| ID | è§„åˆ™ | è¯´æ˜ | å½±å“ä»»åŠ¡ |
|----|------|------|---------|
| BR1 | éš§é“æœªå¯åŠ¨æ—¶ï¼Œæ‰€æœ‰éš§é“ UI éšè— | Header æŒ‡ç¤ºå™¨ä¸æ˜¾ç¤ºï¼Œ/tunnel é¡µæ˜¾ç¤º"æœªå¯åŠ¨" | DT-010, DT-011 |
| BR2 | tunnel-status.json ä¸å­˜åœ¨ç­‰åŒäº"æœªå¯åŠ¨" | API è¿”å› `{ status: "off" }` | DT-002, DT-003 |
| BR3 | tunnel.sh stop å¿…é¡»æ¸…ç† PID å’ŒçŠ¶æ€æ–‡ä»¶ | é¿å…åƒµå°¸çŠ¶æ€ | DT-001 |

### 6.2 è®¤è¯è§„åˆ™

| ID | è§„åˆ™ | è¯´æ˜ | å½±å“ä»»åŠ¡ |
|----|------|------|---------|
| BR4 | æœ¬åœ°è®¿é—®æ— éœ€è®¤è¯ | localhost / 127.0.0.1 ç›´æ¥é€šè¿‡ | å…¨å±€ |
| BR5 | è¿œç¨‹è®¤è¯å®Œå…¨ç”± CF Access å¤„ç† | åº”ç”¨å±‚ä¸åšä»»ä½•è®¤è¯é€»è¾‘ | å…¨å±€ |

### 6.3 å“åº”å¼è§„åˆ™

| ID | è§„åˆ™ | è¯´æ˜ | å½±å“ä»»åŠ¡ |
|----|------|------|---------|
| BR6 | æ–­ç‚¹ < 768px æ˜¾ç¤ºåº•éƒ¨å¯¼èˆª | éšè—æ¡Œé¢ç«¯ TabBarï¼Œæ˜¾ç¤º MobileNav | DT-008, DT-012 |
| BR7 | æ–­ç‚¹ >= 768px ä¿æŒæ¡Œé¢å¸ƒå±€ | TabBar æ­£å¸¸æ˜¾ç¤ºï¼ŒMobileNav éšè— | DT-008, DT-012 |
| BR8 | å¹³æ¿ä½¿ç”¨æ¡Œé¢å¸ƒå±€ | ä¸åšå¹³æ¿ä¸“ç”¨é€‚é… | å…¨å±€ |

### 6.4 æ¨é€è§„åˆ™

| ID | è§„åˆ™ | è¯´æ˜ | å½±å“ä»»åŠ¡ |
|----|------|------|---------|
| BR9 | 4 ç±»æ¨é€äº‹ä»¶ | agent_complete, agent_error, test_result, user_action_needed | DT-018 |
| BR10 | VAPID å¯†é’¥é¦–æ¬¡è®¢é˜…æ—¶è‡ªåŠ¨ç”Ÿæˆ | æ£€æŸ¥ .vapid-keys.json æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™ç”Ÿæˆ | DT-015 |
| BR11 | SSE ç”¨äºå‰å°å®æ—¶ï¼ŒPush ç”¨äºåå° | å‰å°æ‰“å¼€æ—¶èµ° SSE æµï¼Œé”å±/åå°èµ° Web Push | DT-017, DT-018 |
| BR12 | .vapid-keys.json åŠ å…¥ .gitignore | å¯†é’¥ä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ | DT-015 |

### 6.5 PWA è§„åˆ™

| ID | è§„åˆ™ | è¯´æ˜ | å½±å“ä»»åŠ¡ |
|----|------|------|---------|
| BR13 | SW ç¼“å­˜ç­–ç•¥: é™æ€ Cache First, API Network First | é™æ€èµ„æºä¼˜å…ˆç¼“å­˜ï¼ŒAPI è¯·æ±‚ä¼˜å…ˆç½‘ç»œ | DT-005 |
| BR14 | ç¦»çº¿æ—¶æ˜¾ç¤º /offline å›é€€é¡µ | SW ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶è¿”å›ç¼“å­˜çš„ offline.html | DT-005 |

### 6.6 å†³ç­–æ ‘: éš§é“çŠ¶æ€æ£€æµ‹

```
Viewer å¯åŠ¨ / é¡µé¢åŠ è½½
â”œâ”€â”€ è¯»å– /api/tunnel/status
â”‚   â”œâ”€â”€ tunnel-status.json å­˜åœ¨?
â”‚   â”‚   â”œâ”€â”€ æ˜¯ â†’ è¯»å– status å­—æ®µ
â”‚   â”‚   â”‚   â”œâ”€â”€ "running" â†’ Header æ˜¾ç¤ºç»¿ç‚¹ï¼Œ/tunnel æ˜¾ç¤º URL
â”‚   â”‚   â”‚   â”œâ”€â”€ "starting" â†’ Header æ˜¾ç¤ºé»„ç‚¹
â”‚   â”‚   â”‚   â””â”€â”€ "stopped" â†’ éšè—éš§é“ UI
â”‚   â”‚   â””â”€â”€ å¦ â†’ éšè—éš§é“ UI
â”‚   â””â”€â”€ API é”™è¯¯ â†’ éšè—éš§é“ UI
â””â”€â”€ å®šæ—¶è½®è¯¢ (10s é—´éš”)
```

## 7. å¼€å‘è®¡åˆ’

### 7.0 Phase ä¾èµ–å›¾

```
Phase 1 â”€â”€â–¶ Phase 3
éš§é“åŸºå»º     ç§»åŠ¨ç«¯ UI
(P0)         (P0)

Phase 2 â”€â”€â–¶ Phase 4
PWA åŸºç¡€     æ¨é€é€šçŸ¥
(P0)         (P1)

Phase 1 + 2 å¯å¹¶è¡Œ
Phase 3 + 4 å¯å¹¶è¡Œï¼ˆåœ¨å„è‡ªå‰ç½®å®Œæˆåï¼‰
```

### 7.1 Phase 1: éš§é“åŸºå»º (P0)

> **å‰ç½®**: æ— 
> **äº§å‡º**: å¯é€šè¿‡ `scripts/tunnel.sh start` ä¸€é”®å¯åŠ¨ Cloudflare Tunnelï¼ŒViewer å¯è¯»å–éš§é“çŠ¶æ€
> **å¯¹åº”è®¾è®¡**: Section 3.4, 4.2, 6.1

- [ ] DT-001: tunnel.sh è„šæœ¬ â€” start/stop/status ä¸‰ä¸ªå­å‘½ä»¤ (`æ–‡ä»¶: scripts/tunnel.sh`)
  - éªŒæ”¶æ ‡å‡†:
    - `tunnel.sh start` å¯åŠ¨ cloudflared å¹¶å°† URL å†™å…¥ tunnel-status.json
    - `tunnel.sh stop` ç»ˆæ­¢ cloudflared è¿›ç¨‹å¹¶æ¸…ç†çŠ¶æ€æ–‡ä»¶
    - `tunnel.sh status` è¾“å‡ºå½“å‰éš§é“çŠ¶æ€ï¼ˆrunning/stopped + URLï¼‰
    - è‡ªåŠ¨æ£€æµ‹ cloudflared æ˜¯å¦å·²å®‰è£…ï¼Œæœªå®‰è£…æ—¶æç¤ºå®‰è£…å‘½ä»¤
    - å¯åŠ¨æ—¶åœ¨ç»ˆç«¯æ‰“å°éš§é“ URL å¹¶è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆmacOS: pbcopyï¼‰
    - ä½¿ç”¨ PID æ–‡ä»¶è¿½è¸ªè¿›ç¨‹ï¼Œé¿å…é‡å¤å¯åŠ¨
    - [å®‰å…¨] çŠ¶æ€æ–‡ä»¶è·¯å¾„ä¸å¯ç”±å¤–éƒ¨è¾“å…¥æ§åˆ¶
    - Typecheck passes (N/A - shell script)

- [ ] DT-002: tunnel-status.json çŠ¶æ€æ–‡ä»¶è§„èŒƒ (`æ–‡ä»¶: viewer/src/lib/tunnel-status.ts`)
  - éªŒæ”¶æ ‡å‡†:
    - å®šä¹‰ TypeScript ç±»å‹ `TunnelStatus { status, url?, pid?, startedAt?, service }`
    - å®ç° `readTunnelStatus()` å‡½æ•°ï¼Œæ–‡ä»¶ä¸å­˜åœ¨æ—¶è¿”å› `{ status: "off" }`
    - çŠ¶æ€æ–‡ä»¶è·¯å¾„ä½¿ç”¨ `@/lib/project-root` è·å–ç»å¯¹è·¯å¾„
    - [å®‰å…¨] æ–‡ä»¶è¯»å–ä½¿ç”¨ try/catchï¼Œé”™è¯¯ä¸æ³„éœ²å†…éƒ¨è·¯å¾„
    - Typecheck passes

- [ ] DT-003: /api/tunnel/status API ç«¯ç‚¹ (`API: GET /api/tunnel/status`, `æ–‡ä»¶: viewer/src/app/api/tunnel/status/route.ts`)
  - éªŒæ”¶æ ‡å‡†:
    - GET è¯·æ±‚è¿”å› `{ status, url?, pid?, startedAt?, uptime? }`
    - éš§é“æœªå¯åŠ¨æ—¶è¿”å› `{ status: "off" }`
    - è®¡ç®— uptimeï¼ˆå½“å‰æ—¶é—´ - startedAtï¼‰
    - handler ä½¿ç”¨ try/catch åŒ…è£¹ï¼Œé”™è¯¯è¿”å› `{ error: string }` + 500
    - [å®‰å…¨] é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯
    - Typecheck passes

### 7.2 Phase 2: PWA åŸºç¡€ (P0)

> **å‰ç½®**: æ— 
> **äº§å‡º**: Viewer å¯ä½œä¸º PWA å®‰è£…åˆ°æ‰‹æœºä¸»å±å¹•ï¼Œæ”¯æŒ App Shell ç¦»çº¿ç¼“å­˜
> **å¯¹åº”è®¾è®¡**: Section 4.2, 5.1, 6.5

- [ ] DT-004: PWA manifest.json + å›¾æ ‡ (`æ–‡ä»¶: viewer/public/manifest.json`, `viewer/public/icons/`)
  - éªŒæ”¶æ ‡å‡†:
    - åˆ›å»º manifest.jsonï¼ŒåŒ…å« nameã€short_nameã€start_urlã€display:standaloneã€theme_color
    - ç”Ÿæˆ 3 ç§å°ºå¯¸å›¾æ ‡: 192x192ã€512x512ã€512x512 maskable
    - background_color: #fafafa (neutral-50), theme_color: #171717 (neutral-900)
    - Verify in browser: Chrome DevTools Application é¢æ¿æ˜¾ç¤º manifest ä¿¡æ¯
    - Typecheck passes (N/A - static files)

- [ ] DT-005: Service Worker â€” App Shell ç¼“å­˜ + ç¦»çº¿å›é€€ (`æ–‡ä»¶: viewer/public/sw.js`, `viewer/src/app/offline/page.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - å®ç° install äº‹ä»¶: é¢„ç¼“å­˜ App Shellï¼ˆHTML æ¡†æ¶ã€CSSã€JS bundleã€å›¾æ ‡ï¼‰
    - å®ç° fetch äº‹ä»¶: é™æ€èµ„æº Cache Firstï¼ŒAPI è¯·æ±‚ Network First
    - ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶è¿”å› /offline ç¦»çº¿å›é€€é¡µ
    - å®ç° activate äº‹ä»¶: æ¸…ç†æ—§ç‰ˆæœ¬ç¼“å­˜ï¼ˆç‰ˆæœ¬å·æ§åˆ¶ï¼‰
    - ä½¿ç”¨ skipWaiting + clients.claim ç¡®ä¿ç«‹å³æ¿€æ´»
    - åˆ›å»º /offline é¡µé¢: ç®€æ´çš„"è¿æ¥å·²æ–­å¼€"æç¤º + é‡è¯•æŒ‰é’®
    - [å®‰å…¨] ä¸ç¼“å­˜è®¤è¯ç›¸å…³å“åº”
    - Verify in browser: æ–­ç½‘åæ˜¾ç¤ºç¦»çº¿å›é€€é¡µ
    - Typecheck passes

- [ ] DT-006: layout.tsx PWA meta æ ‡ç­¾ + viewport (`æ–‡ä»¶: viewer/src/app/layout.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - æ·»åŠ  `<link rel="manifest" href="/manifest.json">`
    - æ·»åŠ  `<meta name="theme-color" content="#171717">`
    - æ·»åŠ  `<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">`
    - æ·»åŠ  Apple PWA meta æ ‡ç­¾: `apple-mobile-web-app-capable`ã€`apple-mobile-web-app-status-bar-style`
    - æ·»åŠ  `<link rel="apple-touch-icon" href="/icons/icon-192.png">`
    - æ³¨å†Œ Service Workerï¼ˆå®¢æˆ·ç«¯ç»„ä»¶æˆ– script æ ‡ç­¾ï¼‰
    - Verify in browser: iOS Safari æ·»åŠ åˆ°ä¸»å±å¹•åä»¥ standalone æ¨¡å¼æ‰“å¼€
    - Typecheck passes

- [ ] DT-007: PWA å®‰è£…æç¤ºç»„ä»¶ (`ç»„ä»¶: <InstallPrompt>`, `æ–‡ä»¶: viewer/src/components/InstallPrompt.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - ç›‘å¬ `beforeinstallprompt` äº‹ä»¶ï¼Œæ˜¾ç¤ºå®‰è£… Banner
    - Banner åŒ…å«"å®‰è£… Botool Agent"æ–‡å­— + å®‰è£…æŒ‰é’® + å…³é—­æŒ‰é’®
    - å®‰è£…æˆ–å…³é—­åä¸å†æ˜¾ç¤ºï¼ˆlocalStorage è®°å½•ï¼‰
    - iOS ä¸Šæ˜¾ç¤º"æ·»åŠ åˆ°ä¸»å±å¹•"çš„å¼•å¯¼æç¤ºï¼ˆSafari ä¸æ”¯æŒ beforeinstallpromptï¼‰
    - ä½¿ç”¨ shadcn Button ç»„ä»¶
    - Verify in browser: Chrome Android æ˜¾ç¤ºå®‰è£…æç¤º
    - Typecheck passes

### 7.3 Phase 3: ç§»åŠ¨ç«¯ UI (P0)

> **å‰ç½®**: Phase 1ï¼ˆéš§é“çŠ¶æ€è¯»å–ï¼‰
> **äº§å‡º**: æ‰€æœ‰é¡µé¢é€‚é…æ‰‹æœºå±å¹•ï¼Œåº•éƒ¨å¯¼èˆª + åº•éƒ¨æŠ½å±‰æä¾›æµç•…ç§»åŠ¨ä½“éªŒ
> **å¯¹åº”è®¾è®¡**: Section 5.2-5.5, 6.3

- [ ] DT-008: MobileNav åº•éƒ¨å¯¼èˆªæ  (`ç»„ä»¶: <MobileNav>`, `æ–‡ä»¶: viewer/src/components/MobileNav.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - 4 ä¸ª Tab: é¦–é¡µ(LayoutDashboard)ã€é¡¹ç›®(FolderOpen)ã€éš§é“(Link)ã€è®¾ç½®(Settings)
    - ä»…åœ¨ < 768px æ—¶æ˜¾ç¤ºï¼ˆTailwind: `md:hidden`ï¼‰
    - å½“å‰ Tab é«˜äº®ï¼ˆneutral-900 å›¾æ ‡ + æ–‡å­—ï¼‰ï¼Œéæ´»è·ƒä¸º neutral-400
    - é¡¹ç›® Tab ç‚¹å‡»è¿›å…¥å½“å‰æ´»è·ƒé¡¹ç›®çš„ Stage è§†å›¾
    - è®¾ç½® Tab è·³è½¬åˆ° /rules é¡µé¢
    - å›ºå®šåœ¨é¡µé¢åº•éƒ¨ï¼Œz-index é«˜äºå†…å®¹
    - ä½¿ç”¨ lucide-react å›¾æ ‡
    - Verify in browser: æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­åº•éƒ¨å¯¼èˆªæ­£å¸¸å·¥ä½œ
    - Typecheck passes

- [ ] DT-009: BottomSheet å¯æ‹–æ‹½æŠ½å±‰ç»„ä»¶ (`ç»„ä»¶: <BottomSheet>`, `æ–‡ä»¶: viewer/src/components/BottomSheet.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - Props: `{ children, title, defaultSnap?: 'collapsed' | 'expanded' }`
    - ä¸¤æ¡£å¡ç‚¹: æ”¶èµ·ï¼ˆä»…æ ‡é¢˜æ  ~48pxï¼‰ã€å±•å¼€ï¼ˆ70% é«˜åº¦ï¼‰
    - æ”¯æŒè§¦æ‘¸æ‹–æ‹½å’Œé¼ æ ‡æ‹–æ‹½
    - æ ‡é¢˜æ æ˜¾ç¤ºæ‹–æ‹½æ‰‹æŸ„ï¼ˆçŸ­æ¨ªçº¿ï¼‰+ æ ‡é¢˜æ–‡å­—
    - åŠ¨ç”»ä½¿ç”¨ transform translateYï¼ˆGPU åŠ é€Ÿï¼‰
    - ä»…åœ¨ < 768px æ—¶æ¸²æŸ“ï¼ˆå¤§å±ä½¿ç”¨åŸæœ‰ä¾§è¾¹é¢æ¿å¸ƒå±€ï¼‰
    - Verify in browser: æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­æ‹–æ‹½æµç•…
    - Typecheck passes

- [ ] DT-010: TunnelIndicator Header éš§é“æŒ‡ç¤ºå™¨ (`ç»„ä»¶: <TunnelIndicator>`, `æ–‡ä»¶: viewer/src/components/TunnelIndicator.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - è°ƒç”¨ `/api/tunnel/status` è·å–çŠ¶æ€ï¼ˆ10s è½®è¯¢ï¼‰
    - éš§é“ running: æ˜¾ç¤ºç»¿è‰²åœ†ç‚¹ï¼Œç‚¹å‡»å¼¹å‡º Popoverï¼ˆURL + å¤åˆ¶æŒ‰é’®ï¼‰
    - éš§é“ starting: æ˜¾ç¤ºé»„è‰²åœ†ç‚¹ï¼ˆé—ªçƒï¼‰
    - éš§é“ off/stopped: ç»„ä»¶ä¸æ¸²æŸ“ï¼ˆå®Œå…¨éšè—ï¼‰
    - ä½¿ç”¨ shadcn Popover ç»„ä»¶ï¼ŒèƒŒæ™¯ç™½è‰²
    - å¤åˆ¶æŒ‰é’®ç‚¹å‡»åæ˜¾ç¤º"å·²å¤åˆ¶"åé¦ˆ
    - Verify in browser: éš§é“å¯åŠ¨åæŒ‡ç¤ºå™¨æ˜¾ç¤º
    - Typecheck passes

- [ ] DT-011: éš§é“ç®¡ç†é¡µ /tunnel (`é¡µé¢: /tunnel`, `æ–‡ä»¶: viewer/src/app/tunnel/page.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - å±•ç¤ºéš§é“çŠ¶æ€å¡ç‰‡: çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆå½©è‰²åœ†ç‚¹ï¼‰+ URL + è¿è¡Œæ—¶é•¿
    - éš§é“ off æ—¶æ˜¾ç¤º"éš§é“æœªå¯åŠ¨"+ ç»ˆç«¯å‘½ä»¤æç¤º
    - URL å¤åˆ¶æŒ‰é’®ï¼ˆä½¿ç”¨ navigator.clipboard APIï¼‰
    - å“åº”å¼: ç§»åŠ¨ç«¯å…¨å®½å¡ç‰‡ï¼Œæ¡Œé¢ç«¯å±…ä¸­ max-w-md
    - è°ƒç”¨ `/api/tunnel/status` è·å–æ•°æ®ï¼ˆ10s è½®è¯¢ï¼‰
    - Verify in browser: éš§é“é¡µé¢å„çŠ¶æ€æ­£ç¡®æ˜¾ç¤º
    - Typecheck passes

- [ ] DT-012: Header å“åº”å¼é€‚é… (`æ–‡ä»¶: viewer/src/components/Header.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - < 768px: éšè— TabBarã€ClaudeProcessesã€CurrentTimeã€repoName
    - < 768px: ä»…æ˜¾ç¤ºå“ç‰Œå + TunnelIndicator
    - >= 768px: ä¿æŒç°æœ‰æ¡Œé¢å¸ƒå±€ä¸å˜
    - ä½¿ç”¨ Tailwind å“åº”å¼ç±»: `hidden md:flex` / `md:hidden`
    - ä¸ä¿®æ”¹æ¡Œé¢ç«¯ä»»ä½•ç°æœ‰è¡Œä¸º
    - Verify in browser: åˆ‡æ¢çª—å£å¤§å°æ—¶ Header æ­£ç¡®åˆ‡æ¢
    - Typecheck passes

- [ ] DT-013: Main + layout é€‚é…åº•éƒ¨å¯¼èˆªç©ºé—´ (`æ–‡ä»¶: viewer/src/components/Main.tsx`, `viewer/src/app/layout.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - Main ç»„ä»¶åœ¨ < 768px æ—¶æ·»åŠ åº•éƒ¨ paddingï¼ˆä¸º MobileNav ç•™å‡ºç©ºé—´ï¼‰
    - layout.tsx ä¸­æ·»åŠ  MobileNav ç»„ä»¶ï¼ˆåœ¨ Main ä¹‹åï¼‰
    - ä½¿ç”¨ `pb-16 md:pb-0` æ§åˆ¶åº•éƒ¨ç©ºé—´
    - ä¸å½±å“æ¡Œé¢ç«¯å¸ƒå±€
    - Verify in browser: ç§»åŠ¨ç«¯å†…å®¹ä¸è¢«åº•éƒ¨å¯¼èˆªé®æŒ¡
    - Typecheck passes

- [ ] DT-014: Stage é¡µé¢å“åº”å¼é€‚é… â€” åˆ†æ å˜æŠ½å±‰ (`æ–‡ä»¶: viewer/src/app/stage3/page.tsx`, `stage4/page.tsx`, `stage5/page.tsx`, `stage1/page.tsx`, `page.tsx`, `rules/page.tsx`)
  - éªŒæ”¶æ ‡å‡†:
    - < 768px: å·¦å³åˆ†æ å¸ƒå±€æ›¿æ¢ä¸ºä¸»å†…å®¹ + BottomSheet
    - BottomSheet å†…å®¹ä¸ºåŸå³ä¾§é¢æ¿ï¼ˆæ—¥å¿—ã€Agent æ•°æ®ç­‰ï¼‰
    - >= 768px: ä¿æŒç°æœ‰åˆ†æ å¸ƒå±€ä¸å˜
    - Stage1 çš„ PRD ç¼–è¾‘å™¨: ç§»åŠ¨ç«¯ä½¿ç”¨å…¨å®½å¸ƒå±€
    - Dashboard: é¡¹ç›®å¡ç‰‡æ”¹ä¸ºå•åˆ—å †å 
    - Rules é¡µé¢: ç§»åŠ¨ç«¯ä½¿ç”¨å‚ç›´å¸ƒå±€
    - ä½¿ç”¨ Tailwind å“åº”å¼ç±»æˆ– useMediaQuery hook
    - Verify in browser: å„ Stage é¡µé¢åœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸­æ­£ç¡®æ˜¾ç¤º
    - Typecheck passes

### 7.4 Phase 4: æ¨é€é€šçŸ¥ (P1)

> **å‰ç½®**: Phase 2ï¼ˆService Worker å·²æ³¨å†Œï¼‰
> **äº§å‡º**: Agent çŠ¶æ€å˜æ›´æ—¶è‡ªåŠ¨å‘é€æ¨é€é€šçŸ¥åˆ°è®¢é˜…è®¾å¤‡ï¼Œå‰å°æ‰“å¼€æ—¶ SSE å®æ—¶æ›´æ–°
> **å¯¹åº”è®¾è®¡**: Section 4.2, 6.4

- [ ] DT-015: VAPID å¯†é’¥ + /api/push/subscribe ç«¯ç‚¹ (`API: POST /api/push/subscribe`, `GET /api/push/vapid-public`, `æ–‡ä»¶: viewer/src/app/api/push/subscribe/route.ts`, `viewer/src/app/api/push/vapid-public/route.ts`)
  - éªŒæ”¶æ ‡å‡†:
    - GET `/api/push/vapid-public` è¿”å› VAPID å…¬é’¥ï¼ˆé¦–æ¬¡è°ƒç”¨æ—¶è‡ªåŠ¨ç”Ÿæˆå¯†é’¥å¯¹ï¼‰
    - POST `/api/push/subscribe` æ¥æ”¶ PushSubscription å¯¹è±¡ï¼Œå­˜å…¥ push-subscriptions.json
    - å¯†é’¥å¯¹å­˜å‚¨åœ¨ .vapid-keys.jsonï¼ˆè‡ªåŠ¨åŠ å…¥ .gitignoreï¼‰
    - ä½¿ç”¨ `web-push` npm åŒ…ç”Ÿæˆ VAPID å¯†é’¥
    - [å®‰å…¨] VAPID ç§é’¥ä¸é€šè¿‡ API æš´éœ²
    - [å®‰å…¨] è®¢é˜…ç«¯ç‚¹éªŒè¯ schemaï¼ˆendpoint å¿…é¡»ä¸º https URLï¼‰
    - [å®‰å…¨] é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯
    - Typecheck passes

- [ ] DT-016: /api/push/send æ¨é€å‘é€ API (`API: POST /api/push/send`, `æ–‡ä»¶: viewer/src/app/api/push/send/route.ts`)
  - éªŒæ”¶æ ‡å‡†:
    - POST è¯·æ±‚æ¥æ”¶ `{ type, title, body, url? }`
    - éå† push-subscriptions.json ä¸­æ‰€æœ‰è®¢é˜…ï¼Œé€ä¸ªå‘é€
    - å‘é€å¤±è´¥çš„è®¢é˜…ï¼ˆ410 Goneï¼‰è‡ªåŠ¨ä»åˆ—è¡¨ä¸­ç§»é™¤
    - 4 ç±»æ¨é€äº‹ä»¶: agent_complete, agent_error, test_result, user_action_needed
    - æ¨é€ payload åŒ…å« titleã€bodyã€iconã€click è·³è½¬ URL
    - ä½¿ç”¨ `web-push` npm åŒ…å‘é€
    - [å®‰å…¨] ä»…æ¥å—å†…éƒ¨è°ƒç”¨ï¼ˆæ£€æŸ¥ localhost origin æˆ– shared secretï¼‰
    - [å®‰å…¨] é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯
    - Typecheck passes

- [ ] DT-017: SSE å®æ—¶äº‹ä»¶æµ (`API: GET /api/sse/events`, `æ–‡ä»¶: viewer/src/app/api/sse/events/route.ts`)
  - éªŒæ”¶æ ‡å‡†:
    - GET è¯·æ±‚è¿”å› `text/event-stream` å“åº”
    - ç›‘å¬ agent-status.json å˜åŒ–ï¼ˆfs.watch æˆ–è½®è¯¢ï¼‰
    - äº‹ä»¶ç±»å‹: `agent_status`ï¼ˆçŠ¶æ€å˜æ›´ï¼‰ã€`tunnel_status`ï¼ˆéš§é“å˜æ›´ï¼‰
    - å®¢æˆ·ç«¯æ–­å¼€æ—¶æ¸…ç† watcher/interval
    - å‰ç«¯ä½¿ç”¨ EventSource API è¿æ¥
    - æ¯ 30s å‘é€ heartbeat ä¿æŒè¿æ¥
    - [å®‰å…¨] é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯
    - Typecheck passes

- [ ] DT-018: Agent çŠ¶æ€å˜æ›´è§¦å‘æ¨é€ + SW æ¨é€æ¥æ”¶ (`æ–‡ä»¶: viewer/src/app/api/agent/status/route.ts`, `viewer/public/sw.js`)
  - éªŒæ”¶æ ‡å‡†:
    - agent/status API åœ¨å†™å…¥çŠ¶æ€å˜æ›´æ—¶ï¼Œæ£€æµ‹æ˜¯å¦éœ€è¦æ¨é€
    - åŒ¹é… 4 ç±»æ¨é€äº‹ä»¶: complete â†’ "ä»»åŠ¡å®Œæˆ"ã€error â†’ "é‡åˆ°é”™è¯¯"ã€test done â†’ "æµ‹è¯•å®Œæˆ"ã€waiting_for_user â†’ "éœ€è¦ç¡®è®¤"
    - è°ƒç”¨ /api/push/send å‘é€æ¨é€
    - Service Worker ä¸­å¤„ç† `push` äº‹ä»¶: æ˜¾ç¤ºç³»ç»Ÿé€šçŸ¥
    - Service Worker ä¸­å¤„ç† `notificationclick` äº‹ä»¶: ç‚¹å‡»é€šçŸ¥è·³è½¬åˆ°å¯¹åº”é¡µé¢
    - Verify in browser: Agent çŠ¶æ€å˜æ›´åæ‰‹æœºæ”¶åˆ°æ¨é€é€šçŸ¥
    - Typecheck passes

## 8. é™„å½•

### A. ä»£ç æ–‡ä»¶ç´¢å¼•

| æ–‡ä»¶è·¯å¾„ | çŠ¶æ€ | Phase | ä»»åŠ¡ |
|---------|------|-------|------|
| `scripts/tunnel.sh` | æ–°å»º | Phase 1 | DT-001 |
| `viewer/src/lib/tunnel-status.ts` | æ–°å»º | Phase 1 | DT-002 |
| `viewer/src/app/api/tunnel/status/route.ts` | æ–°å»º | Phase 1 | DT-003 |
| `viewer/public/manifest.json` | æ–°å»º | Phase 2 | DT-004 |
| `viewer/public/icons/icon-*.png` | æ–°å»º | Phase 2 | DT-004 |
| `viewer/public/sw.js` | æ–°å»º | Phase 2 | DT-005, DT-018 |
| `viewer/src/app/offline/page.tsx` | æ–°å»º | Phase 2 | DT-005 |
| `viewer/src/app/layout.tsx` | ä¿®æ”¹ | Phase 2,3 | DT-006, DT-013 |
| `viewer/src/components/InstallPrompt.tsx` | æ–°å»º | Phase 2 | DT-007 |
| `viewer/src/components/MobileNav.tsx` | æ–°å»º | Phase 3 | DT-008 |
| `viewer/src/components/BottomSheet.tsx` | æ–°å»º | Phase 3 | DT-009 |
| `viewer/src/components/TunnelIndicator.tsx` | æ–°å»º | Phase 3 | DT-010 |
| `viewer/src/app/tunnel/page.tsx` | æ–°å»º | Phase 3 | DT-011 |
| `viewer/src/components/Header.tsx` | ä¿®æ”¹ | Phase 3 | DT-012 |
| `viewer/src/components/Main.tsx` | ä¿®æ”¹ | Phase 3 | DT-013 |
| `viewer/src/app/stage3/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/stage4/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/stage5/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/stage1/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/rules/page.tsx` | ä¿®æ”¹ | Phase 3 | DT-014 |
| `viewer/src/app/api/push/subscribe/route.ts` | æ–°å»º | Phase 4 | DT-015 |
| `viewer/src/app/api/push/vapid-public/route.ts` | æ–°å»º | Phase 4 | DT-015 |
| `viewer/src/app/api/push/send/route.ts` | æ–°å»º | Phase 4 | DT-016 |
| `viewer/src/app/api/sse/events/route.ts` | æ–°å»º | Phase 4 | DT-017 |
| `viewer/src/app/api/agent/status/route.ts` | ä¿®æ”¹ | Phase 4 | DT-018 |

### B. é£é™©ä¸ç¼“è§£æªæ–½

#### HIGH
- **iOS Safari å¯¹ Web Push æ”¯æŒæœ‰é™**: iOS 16.4+ æ‰æ”¯æŒ PWA Web Pushï¼Œä¸”éœ€ç”¨æˆ·æ˜ç¡®æˆæƒ â†’ **ç¼“è§£**: é™çº§ä¸º SSE å®æ—¶é€šçŸ¥ï¼ˆå‰å°æ‰“å¼€æ—¶ï¼‰ï¼ŒiOS ä¸æ”¯æŒæ—¶åœ¨ UI ä¸­è¯´æ˜

#### MEDIUM
- **cloudflared URL æ¯æ¬¡å¯åŠ¨å˜åŒ–**: å…è´¹éš§é“ä¸æ”¯æŒå›ºå®šåŸŸå â†’ **ç¼“è§£**: tunnel-status.json è‡ªåŠ¨æ›´æ–°ï¼ŒTunnelIndicator å®æ—¶æ˜¾ç¤ºæœ€æ–° URL
- **Service Worker ç¼“å­˜æ›´æ–°**: ç”¨æˆ·å¯èƒ½çœ‹åˆ°æ—§ç‰ˆé¡µé¢ â†’ **ç¼“è§£**: ç‰ˆæœ¬å·æ§åˆ¶ + skipWaiting + æ›´æ–°æç¤º

#### LOW
- **BottomSheet è§¦æ‘¸æ‰‹åŠ¿å†²çª**: å¯èƒ½ä¸é¡µé¢å†…éƒ¨æ»šåŠ¨å†²çª â†’ **ç¼“è§£**: ä»…åœ¨æ‹–æ‹½æ‰‹æŸ„åŒºåŸŸå“åº”æ‹–æ‹½ï¼Œå†…éƒ¨å†…å®¹åŒºåŸŸæ­£å¸¸æ»šåŠ¨
- **Web Push é…é¢é™åˆ¶**: æµè§ˆå™¨å¯èƒ½é™åˆ¶æ¨é€é¢‘ç‡ â†’ **ç¼“è§£**: åˆå¹¶åŒç±»é€šçŸ¥ï¼Œæ¯ç±»äº‹ä»¶æœ€å¤š 1 æ¬¡/åˆ†é’Ÿ

### C. æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•
- `readTunnelStatus()` å‡½æ•°: æ–‡ä»¶å­˜åœ¨/ä¸å­˜åœ¨/æ ¼å¼é”™è¯¯
- tunnel-status.json schema éªŒè¯
- Push subscription å­˜å‚¨/è¯»å–/åˆ é™¤

#### é›†æˆæµ‹è¯•
- `/api/tunnel/status` ç«¯ç‚¹: å„ç§çŠ¶æ€è¿”å›å€¼
- `/api/push/subscribe` + `/api/push/send` å®Œæ•´æµç¨‹
- SSE è¿æ¥å»ºç«‹å’Œäº‹ä»¶æ¨é€

#### E2E æµ‹è¯•
- PWA å®‰è£…æµç¨‹ï¼ˆChrome DevTools Lighthouse auditï¼‰
- ç§»åŠ¨ç«¯å¯¼èˆª: åº•éƒ¨ Tab åˆ‡æ¢
- BottomSheet æ‹–æ‹½: æ”¶èµ·/å±•å¼€
- å“åº”å¼æ–­ç‚¹: 768px åˆ‡æ¢æ¡Œé¢/ç§»åŠ¨å¸ƒå±€
- éš§é“æŒ‡ç¤ºå™¨: åœ¨çº¿/ç¦»çº¿çŠ¶æ€åˆ‡æ¢

### D. éç›®æ ‡ (Out of Scope)

- âŒ å¤šç”¨æˆ·è´¦æˆ·ç³»ç»Ÿ / æƒé™ç®¡ç†
- âŒ åº”ç”¨å±‚ç™»å½•é¡µ / å¯†ç è®¤è¯
- âŒ å®Œæ•´ç¦»çº¿æ¨¡å¼ï¼ˆç¦»çº¿æ“ä½œï¼‰
- âŒ è‡ªå®šä¹‰åŸŸåé…ç½®
- âŒ åŸç”Ÿ App æ‰“åŒ…ï¼ˆCapacitor/RNï¼‰
- âŒ å¹³æ¿ä¸“ç”¨å¸ƒå±€
- âŒ å¤šéš§é“æœåŠ¡é€‰æ‹©å™¨ï¼ˆbore/ngrokï¼‰
- âŒ å®æ—¶åä½œ / å¤šäººåŒæ—¶è®¿é—®
- âŒ éš§é“è¿œç¨‹å¯åœï¼ˆä»… CLI å¯å¯åœï¼‰

### E. å®‰å…¨æ£€æŸ¥é¡¹

| æ¥æº DT | æ£€æŸ¥é¡¹ |
|---------|--------|
| DT-001 | çŠ¶æ€æ–‡ä»¶è·¯å¾„ä¸å¯ç”±å¤–éƒ¨è¾“å…¥æ§åˆ¶ |
| DT-002 | æ–‡ä»¶è¯»å–ä½¿ç”¨ try/catchï¼Œé”™è¯¯ä¸æ³„éœ²å†…éƒ¨è·¯å¾„ |
| DT-003 | API é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯ |
| DT-005 | Service Worker ä¸ç¼“å­˜è®¤è¯ç›¸å…³å“åº” |
| DT-015 | VAPID ç§é’¥ä¸é€šè¿‡ API æš´éœ² |
| DT-015 | è®¢é˜…ç«¯ç‚¹éªŒè¯ schemaï¼ˆendpoint å¿…é¡»ä¸º https URLï¼‰ |
| DT-015 | .vapid-keys.json åŠ å…¥ .gitignore |
| DT-016 | æ¨é€å‘é€ API ä»…æ¥å—å†…éƒ¨è°ƒç”¨ï¼ˆæ£€æŸ¥ localhost origin æˆ– shared secretï¼‰ |
| DT-016 | é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯ |
| DT-017 | SSE ç«¯ç‚¹é”™è¯¯å“åº”ä¸æ³„éœ²å†…éƒ¨ä¿¡æ¯ |
